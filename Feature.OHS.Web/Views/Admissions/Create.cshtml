@model AdmissionViewModel
@*@{
        Layout = "~/Views/Shared/_Layout.cshtml";
    }*@

<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />


<div id="wrapper">

    <div id="tempSection"></div>

    <!-- Top Bar Start -->
    <div class="topbar">

        <!-- LOGO -->
        <div class="topbar-left">
            <a href="index.html" class="logo"><img src="/images/logo.png" alt="" height="30"></i></a>

        </div>

        <!-- Button mobile view to collapse sidebar menu -->
        <div class="navbar navbar-default" role="navigation">
            <div class="container">

                <!-- Navbar-left -->
                <ul class="nav navbar-nav navbar-left">
                    <li>
                        <button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
                    </li>
                    <li class="hidden-xs">
                        <form role="search" class="app-search">
                            <input type="text" placeholder="Search..." class="form-control">
                            <a href=""><i class="fa fa-search"></i></a>
                        </form>
                    </li>

                </ul>

                <!-- Right(Notification) -->
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" class="right-menu-item dropdown-toggle" data-toggle="dropdown">
                            <i class="mdi mdi-bell"></i>
                            <span class="badge up bg-success">4</span>
                        </a>

                        <ul class="dropdown-menu dropdown-menu-right arrow-dropdown-menu arrow-menu-right dropdown-lg user-list notify-list">
                            <li>
                                <h5>Notifications</h5>
                            </li>
                            <li>
                                <a href="#" class="user-list-item">
                                    <div class="icon bg-info">
                                        <i class="mdi mdi-account"></i>
                                    </div>
                                    <div class="user-desc">
                                        <span class="name">New Signup</span>
                                        <span class="time">5 hours ago</span>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="user-list-item">
                                    <div class="icon bg-danger">
                                        <i class="mdi mdi-comment"></i>
                                    </div>
                                    <div class="user-desc">
                                        <span class="name">New Message received</span>
                                        <span class="time">1 day ago</span>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="user-list-item">
                                    <div class="icon bg-warning">
                                        <i class="mdi mdi-settings"></i>
                                    </div>
                                    <div class="user-desc">
                                        <span class="name">Settings</span>
                                        <span class="time">1 day ago</span>
                                    </div>
                                </a>
                            </li>
                            <li class="all-msgs text-center">
                                <p class="m-0"><a href="#">See all Notification</a></p>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="#" class="right-menu-item dropdown-toggle" data-toggle="dropdown">
                            <i class="mdi mdi-email"></i>
                            <span class="badge up bg-danger">8</span>
                        </a>

                        <ul class="dropdown-menu dropdown-menu-right arrow-dropdown-menu arrow-menu-right dropdown-lg user-list notify-list">
                            <li>
                                <h5>Messages</h5>
                            </li>
                            <li>
                                <a href="#" class="user-list-item">
                                    <div class="avatar">
                                        <img src="/images/users/avatar-2.jpg" alt="">
                                    </div>
                                    <div class="user-desc">
                                        <span class="name">Patricia Beach</span>
                                        <span class="desc">There are new settings available</span>
                                        <span class="time">2 hours ago</span>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="user-list-item">
                                    <div class="avatar">
                                        <img src="/images/users/avatar-3.jpg" alt="">
                                    </div>
                                    <div class="user-desc">
                                        <span class="name">Connie Lucas</span>
                                        <span class="desc">There are new settings available</span>
                                        <span class="time">2 hours ago</span>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="user-list-item">
                                    <div class="avatar">
                                        <img src="/images/users/avatar-4.jpg" alt="">
                                    </div>
                                    <div class="user-desc">
                                        <span class="name">Margaret Becker</span>
                                        <span class="desc">There are new settings available</span>
                                        <span class="time">2 hours ago</span>
                                    </div>
                                </a>
                            </li>
                            <li class="all-msgs text-center">
                                <p class="m-0"><a href="#">See all Messages</a></p>
                            </li>
                        </ul>
                    </li>

                    <li>
                        <a href="javascript:void(0);" class="right-bar-toggle right-menu-item">
                            <i class="mdi mdi-settings"></i>
                        </a>
                    </li>

                    <li class="dropdown user-box">
                        <a href="" class="dropdown-toggle waves-effect user-link" data-toggle="dropdown"
                           aria-expanded="true">
                            <img src="/images/users/avatar-1.jpg" alt="user-img" class="img-circle user-img">
                        </a>

                        <ul class="dropdown-menu dropdown-menu-right arrow-dropdown-menu arrow-menu-right user-list notify-list">
                            <li>
                                <h5>Hi, Shawn Tembe</h5>
                            </li>
                            <li><a href="javascript:void(0)"><i class="ti-user m-r-5"></i> Profile</a></li>
                            <li><a href="javascript:void(0)"><i class="ti-settings m-r-5"></i> Settings</a></li>

                            <li><a href="javascript:void(0)"><i class="ti-power-off m-r-5"></i> Logout</a></li>
                        </ul>
                    </li>

                </ul> <!-- end navbar-right -->

            </div><!-- end container -->
        </div><!-- end navbar -->
    </div>
    <!-- Top Bar End -->
    <div class="row">
        <div class="col-xs-12">
            <div class="page-title-box">
                <h4 class="page-title">Patients </h4>
                <ol class="breadcrumb p-0 m-0">
                    <li>
                        <a href="#">Medipark</a>
                    </li>

                    <li class="active">
                        Patients
                    </li>
                </ol>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
    <!-- end row -->

    <div class="col-sm-12">
        <div class="add-patient-container">
            <h4 class="custom-modal-title">Admitting  @Model.FirstName @Model.LastName </h4>
            <div class="custom-modal-text text-left">


                <!-- Modal -info -->
                <form class="add-patient" asp-action="Create" asp-controller="Admissions" method="post">
                    <ul id="progressbar">
                        <li class="active">Patient Personal Information</li>
                        <li>Account</li>
                        <li>Admission Details </li>
                        <li>Vital Signs</li>
                        <li>Diagnosis</li>
                        <li>Attachments</li>
                        <li>Terms & Conditions</li>
                    </ul>

                    <div class="row"><h2 class="fs-title">Admit a Patient</h2></div>

                    @{
                        @Html.Partial("Admissions/_AdmissionCreatePartial");
                    }

                </form>
            </div>
        </div>


    </div>
</div>

<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" id="onload">

    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header text-primary">
                <a href="/Admissions/Index" class="close" data-dismiss="modal">X</a>
                <h4 class="modal-title"><i class="fa fa-exclamation-circle"></i> Patient Admission Details</h4>
            </div>
            <div class="modal-body">
                <p>@Model.FirstName @Model.LastName has been successfully been admitted!!</p>
            </div>
            <div class="modal-footer">
                <a href="/Admissions/Index" class="btn btn-default">OK</a>
            </div>
        </div>

    </div>
</div>

<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" id="wardError">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header text-primary">
                <a href="javascript:void(0)" data-dismiss="modal" class="close">�</a>
                <h4 class="modal-title"><i class="fa fa-exclamation-circle"></i> Invalid Operation</h4>
            </div>
            <div class="modal-body">
                A ward must be selected first before room!
            </div>
            <div class="modal-footer">
                <a href="javascript:void(0)" data-dismiss="modal" class="btn btn-default">Finish</a>
            </div>
        </div>

    </div>
</div>


@section Scripts{

    @*<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.4.4.min.js"></script>*@

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js'></script>
    <script src='https://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.1/jquery.validate.js'></script>

    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/js/select2.full.min.js"></script>

    <script src="~/js/patient-admission.js"></script>

    @*<script type="text/javascript">
            $(function() {
                $('#paymentOptions').on('change', function (e) {
                    e.preventDefault();

                    //alert("Option event has been fired");
                    var option = $(this).val();
                    if (option === 'medicalAid') {

                        alert("Option has been changed to Medical Aid");

                        var fieldset = $('#paymentOptions').closest('fieldset');

                        var children = fieldset.children(':input[type=text]').remove();

                        console.log(children);
                        //fieldset.children('[readonly]').toggle();
                        //var children = fieldset.children(':input[type=text]');//.prop('readonly', true);

                        console.log(children);

                        $.each(children, (i, child) => {
                            child.remove();
                            //console.log(child);
                            //child.prop('readonly', true);
                        });

                        console.log(children);
                    }
                });
            });
        </script>*@

    <script type="text/javascript">
        $(document).ready(function () {

            //  Subscribe to click event
            $(".partialSubmit").on("click",
                function (e) {
                    e.preventDefault();

                    //  Getting the fieldset currently on view
                    var fieldset = $(this).closest('fieldset');
                    var html = fieldset.html();

                    //console.log(html);
                    //console.log("****************   NEW FORM   ********************");

                    var partialForm = `<form method="post" id="virtualForm">
                                        ${html}
                                       </form>`;
                    //console.log(partialForm);

                    $("#tempSection").html(partialForm).hide();

                    var data = $("#virtualForm").serializeArray();
                    console.log("Serialized form data");
                    console.log(getFormData(data));

                    $("#tempSection").empty();
                });
            function getFormData(data) {
                var unindexed_array = data;
                var indexed_array = {};

                $.map(unindexed_array, function (n, i) {
                    indexed_array[n['name']] = n['value'];
                });

                return indexed_array;
            }
        });
    </script>

    <script>
        var resizefunc = [];
    </script>
}